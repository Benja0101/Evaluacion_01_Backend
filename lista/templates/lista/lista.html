{% extends 'lista/base.html' %}
{% block title %}Contactos{% endblock %}

{% comment %} Tailwind CSS solo para esta vista {% endcomment %}
<script src="https://cdn.tailwindcss.com"></script>

{% block content %}
<h1 class="text-3xl font-extrabold admin-title mb-8 text-center">Contactos</h1>

{% if contactos %}
<div class="accordion">
    {% for c in contactos %}
    <div class="accordion-item border rounded mb-2" id="contact-{{ c.pk }}">
        <button type="button" class="accordion-toggle inline-flex items-center gap-x-4 w-full text-start py-3 px-4 font-semibold"
            aria-controls="contact-{{ c.pk }}-collapse"
            aria-expanded="false"
            aria-labelledby="contact-{{ c.pk }}-heading"
            onclick="toggleAccordion('{{ c.pk }}')">
            <span class="icon-[tabler--plus] size-4.5 block shrink-0" id="icon-plus-{{ c.pk }}">+</span>
            <span class="icon-[tabler--minus] size-4.5 hidden shrink-0" id="icon-minus-{{ c.pk }}">−</span>
            <span id="contact-{{ c.pk }}-heading">{{ c.nombre }}</span>
        </button>
        <div id="contact-{{ c.pk }}-collapse" class="accordion-content hidden w-full overflow-hidden transition-[height] duration-300" aria-labelledby="contact-{{ c.pk }}-heading" role="region">
            <div class="px-5 pb-4">
                <p><strong>Teléfono:</strong> {{ c.telefono }}</p>
                <p><strong>Correo:</strong> {{ c.correo }}</p>
                <p><strong>Dirección:</strong> {{ c.direccion }}</p>
                  <div class="mt-2 flex gap-2">
                     <a href="{% url 'detalle_contacto' c.pk %}"
                         class="inline-flex items-center px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 transition">Ver</a>
                     <a href="{% url 'editar_contacto' c.pk %}"
                         class="inline-flex items-center px-4 py-2 rounded-lg bg-yellow-400 text-gray-900 font-semibold shadow-sm hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-yellow-300 transition">Editar</a>
                     <button onclick="confirmarEliminar('{{ c.pk }}')"
                         class="inline-flex items-center px-4 py-2 rounded-lg bg-red-600 text-white font-semibold shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 transition">Eliminar</button>
                  </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="admin-card p-6 text-center text-gray-600">
        No hay contactos. <a href="{% url 'agregar_contacto' %}" class="admin-link">Agrega uno</a>.
</div>
{% endif %}

<!-- se añade el script para el acordeon-->
<script>
function toggleAccordion(pk) {
    const content = document.getElementById(`contact-${pk}-collapse`);
    const plus = document.getElementById(`icon-plus-${pk}`);
    const minus = document.getElementById(`icon-minus-${pk}`);
    if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        plus.classList.add('hidden');
        minus.classList.remove('hidden');
    } else {
        content.classList.add('hidden');
        plus.classList.remove('hidden');
        minus.classList.add('hidden');
    }
}
</script>
<!-- se carga la libreria de sweetalert2 para las alertas todas wapas -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
function confirmarEliminar(pk){
    Swal.fire({
        title: '¿Estás seguro?',
        text: "¡No podrás revertir esto!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#e3342f',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Sí, eliminar',
        cancelButtonText: 'Cancelar'
    }).then((result) => {
        if(result.isConfirmed){
            window.location.href = '/eliminar/' + pk + '/';
        }
    })
}
</script>
{% endblock %}
